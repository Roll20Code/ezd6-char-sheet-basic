<link rel="stylesheet" href="ezd6-basic.css" />

<div class="sheet-outer-container sheet-background-1">
    <input type="hidden" name="attr_buttonToggle" value="sheet-flex-dir-reverse" />

    <div class="sheet-inner-container sheet-flex-row sheet-gap-h ${buttonToggle}" style="width: 100%; padding: 4px;">
        <!-- Character Sheet -->
        <div class="sheet-flex-col sheet-gap-v" style="width: 100%;">
            <div class="sheet-flex-row sheet-gap-h">
                <!-- Name, Species, etc. -->
                <div class="sheet-flex-col sheet-border-group">
                    <div class="sheet-input-field">
                        <label for="character_name">Name:</label>
                        <input id="character_name" type="text" name="attr_character_name" />
                    </div>

                    <div class="sheet-input-field">
                        <label for="species">Species:</label>
                        <input id="species" type="text" name="attr_character_species" />
                    </div>

                    <div class="sheet-input-field">
                        <label for="path">Hero Path:</label>
                        <input id="path" type="text" name="attr_character_hero_path" />
                    </div>

                    <div class="sheet-input-field">
                        <label for="aspect_1">Aspect 1:</label>
                        <input id="aspect_1" type="text" name="attr_character_aspect_1" />
                    </div>

                    <div class="sheet-input-field">
                        <label for="aspect_1">Aspect 2:</label>
                        <input id="aspect_1" type="text" name="attr_character_aspect_2" />
                    </div>
                </div>

                <!-- Health, Karma, Description, etc. -->
                <div class="sheet-flex-col sheet-flex-centered sheet-border-group sheet-gap-v"
                    style="padding: 4px 4px !important;">
                    <div class="sheet-flex-row sheet-flex-dir-row sheet-flex-centered sheet-gap-h">
                        <div class="sheet-flex-col sheet-flex-centered sheet-attr-group">
                            <label for="health" style="text-align: center;">Health:</label>
                            <input id="health" class="sheet-single-digit" type="number" name="attr_character_health" />
                        </div>

                        <div class="sheet-flex-col sheet-flex-centered sheet-attr-group">
                            <label for="karma" style="text-align: center;">Karma:</label>
                            <input id="karma" class="sheet-single-digit" type="number" name="attr_character_karma" />
                        </div>

                        <div class="sheet-flex-col sheet-flex-centered sheet-attr-group">
                            <label for="armor_save" style="text-align: center;"> Armor Save:</label>
                            <input id="armor_save" class="sheet-single-digit" type="number" name="attr_armor_save" />
                        </div>

                        <div class="sheet-flex-col sheet-flex-centered sheet-attr-group">
                            <label for="hero_die" style="text-align: center;">Hero Die:</label>
                            <input id="hero_die" class="sheet-single-digit" type="number" name="attr_hero_die" />
                        </div>

                        <div class="sheet-flex-col sheet-flex-centered sheet-attr-group">
                            <label for="miraculous_save" style="text-align: center;">Miraculous Save:</label>
                            <input id="miraculous_save" class="sheet-single-digit" type="number"
                                name="attr_miraculous_save" />
                        </div>
                    </div>

                    <div class="sheet-flex-col sheet-flex-centered">
                        <label for="description"
                            style="font-size: 1rem; line-height: 1.2rem; margin-bottom: 2px !important;">Description:</label>
                        <textarea id="description" name="attr_character_description" rows="3" cols="100"
                            style="height: 64px !important;"></textarea>
                    </div>
                </div>
            </div>

            <div class="sheet-flex-row sheet-flex-dir-row sheet-gap-h">
                <div class="sheet-flex-col sheet-flex-centered">
                    <label for="hero_path_features">Hero Path Features:</label>
                    <textarea id="hero_path_features" name="attr_character_hero_path_features" rows="4"
                        cols="100"></textarea>
                </div>

                <div class="sheet-flex-col sheet-flex-centered">
                    <label for="inclinations">Inclinations:</label>
                    <textarea id="inclinations" name="attr_character_inclinations" rows="4" cols="100"></textarea>
                </div>
            </div>

            <div class="sheet-flex-row sheet-flex-dir-row sheet-gap-h">
                <div class="sheet-flex-col sheet-flex-centered">
                    <label for="magick" title="Sorcery Circle(s), etc.">Magick:</label>
                    <textarea id="magick" name="attr_character_magick" rows="4" cols="100"></textarea>
                </div>

                <div class="sheet-flex-col sheet-flex-centered">
                    <label for="equipment" title="Wealth, Weapons, Armor, Gear, etc.">Equipment:</label>
                    <textarea id="equipment" name="attr_character_equipment" rows="4" cols="100"></textarea>
                </div>
            </div>
        </div>

        <!-- Buttons -->
        <div class="sheet-flex-col sheet-button-section sheet-gap-v" style="align-content: start;">
            <div class="sheet-flex-row sheet-flex-centered">
                <div class="sheet-ezd6-logo"></div>
            </div>

            <div class="sheet-flex-col sheet-border-group">
                <button type="roll" name="roll_d6" value="/roll 1d6!k1">Action</button>
                <div class="sheet-flex-row" style="width: 100%;">
                    <button type="roll" name="roll_d6" value="/roll 2d6!k1">w/Boon</button>
                    <button type="roll" name="roll_d6" value="/roll 2d6!kl1">w/Bane</button>
                </div>
            </div>

            <div class="sheet-flex-col sheet-border-group">
                <button type="roll" name="roll_d6" value="/roll 1d6!k1">Attack</button>
                <div class="sheet-flex-row">
                    <button type="roll" name="roll_d6" value="/roll 2d6!k1">w/Boon</button>
                    <button type="roll" name="roll_d6" value="/roll 2d6!kl1">w/Bane</button>
                </div>
            </div>

            <div class="sheet-flex-col sheet-gap-v sheet-border-group">
                <div class="sheet-flex-row sheet-gap-h">
                    <button type="roll" name="roll_d6" value="/roll 1d6" class="sheet-die">1d6</button>
                    <button type="roll" name="roll_d6X" value="/roll 1d6!k1" class="sheet-die">1d6!</button>

                    <button type="roll" name="roll_2d6" value="/roll 2d6k1" class="sheet-die">2d6</button>
                    <button type="roll" name="roll_2d6X" value="/roll 2d6!k1" class="sheet-die">2d6!</button>
                </div>

                <div class="sheet-flex-row sheet-gap-h">
                    <button type="roll" name="roll_3d6" value="/roll 3d6k1" class="sheet-die">3d6</button>
                    <button type="roll" name="roll_3d6X" value="/roll 3d6!k1" class="sheet-die">3d6!</button>

                    <button type="roll" name="roll_4d6" value="/roll 4d6k1" class="sheet-die">4d6</button>
                    <button type="roll" name="roll_4d6X" value="/roll 4d6!k1" class="sheet-die">4d6!</button>
                </div>

                <div class="sheet-flex-row sheet-gap-h">
                    <button type="roll" name="roll_5d6" value="/roll 5d6k1" class="sheet-die">5d6</button>
                    <button type="roll" name="roll_5d6X" value="/roll 5d6!k1" class="sheet-die">5d6!</button>

                    <button type="roll" name="roll_6d6" value="/roll 6d6k1" class="sheet-die">6d6</button>
                    <button type="roll" name="roll_6d6X" value="/roll 6d6!k1" class="sheet-die">6d6!</button>
                </div>
            </div>

            <div class="sheet-flex-col sheet-border-group">
                <span>Options:</span>
                <button type="action" name="act_buttonToggle" style="white-space: nowrap;">Buttons Location</button>
                <select name="attr_backgroundImage" style="width: 100%;">
                    <option value="sheet-background-1">Background 1</option>
                    <option value="sheet-background-2">Background 2</option>
                    <option value="sheet-background-3">Background 3</option>
                    <option value="sheet-background-4">Background 4</option>
                    <option value="sheet-background-5">Background 5</option>
                    <option value="sheet-background-6">Background 6</option>
                    <option value="sheet-background-7">Background 7</option>
                    <option value="sheet-background-8">Background 8</option>
                    <option value="sheet-background-9">Background 9</option>
                </select>
            </div>
        </div>
    </div>
</div>

<script type="text/worker">
    const outerContainer = $20('div.sheet-outer-container');
    const innerContainer = $20('div.sheet-inner-container');

    const backgroundImageClasses = [
        'none',
        'sheet-background-1',
        'sheet-background-2',
        'sheet-background-3',
        'sheet-background-4',
        'sheet-background-5',
        'sheet-background-6',
        'sheet-background-7',
        'sheet-background-8',
        'sheet-background-9',
    ];

    const clearBackgroundImage = () =>
        backgroundImageClasses.forEach((imageClass) => {
            if (imageClass != 'none') {
                outerContainer.removeClass(imageClass);
            }
        });

    on('sheet:opened', () => {
        getAttrs(['buttonToggle', 'backgroundImage'], (data) => {
            console.log('*** sheet:opened: data:', data);

            innerContainer.removeClass('sheet-flex-dir-reverse');

            if (data.buttonToggle === 'sheet-flex-dir-reverse') {
                innerContainer.addClass('sheet-flex-dir-reverse');
            }

            clearBackgroundImage();

            if (data.backgroundImage != 'none') {
                //outerContainer.addClass(data.backgroundImage);
            }
        });
    });

    on('clicked:buttonToggle', () => {
        getAttrs(['buttonToggle'], (data) => {
            if (data.buttonToggle === 'sheet-flex-dir-reverse') {
                setAttrs({ buttonToggle: ' ' });
                innerContainer.removeClass('sheet-flex-dir-reverse');
            } else {
                setAttrs({ buttonToggle: 'sheet-flex-dir-reverse' });
                innerContainer.addClass('sheet-flex-dir-reverse');
            }
        });
    });

    on('change:backgroundImage', (evt) => {
        //outerContainer.removeClass(evt.previousValue);
        //outerContainer.addClass(evt.newValue);
    });
</script>